import{c as w,a as k,r,j as e,m as d,X as L,B as S,u as T,M as E,h as P,i as _}from"./index-BSYKhbqh.js";import{C as c}from"./Card-DTZjnm11.js";import{T as U,L as M,D as K}from"./Disclaimer-BqLl32he.js";import{C}from"./circle-alert-CasAvgUz.js";import{analyzeImage as $}from"./api-ebqt3Pvv.js";import{C as H}from"./camera-Bk_L7nBg.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=w("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=w("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=w("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),X=({onSubmit:t,loading:x})=>{const{t:l}=k(),[s,o]=r.useState(null),[n,f]=r.useState(null),[u,v]=r.useState(""),[g,p]=r.useState(!1),[y,i]=r.useState(""),m=r.useRef(null),b=["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/bmp"],j=10*1024*1024,h=r.useCallback(a=>{if(i(""),!a)return;if(!b.includes(a.type)){i(l("image_analysis.upload.errors.invalid_type"));return}if(a.size>j){i(l("image_analysis.upload.errors.file_size"));return}o(a);const z=new FileReader;z.onload=B=>{f(B.target.result)},z.readAsDataURL(a)},[l]),N=r.useCallback(a=>{a.preventDefault(),a.stopPropagation(),a.type==="dragenter"||a.type==="dragover"?p(!0):a.type==="dragleave"&&p(!1)},[]),A=r.useCallback(a=>{a.preventDefault(),a.stopPropagation(),p(!1),a.dataTransfer.files&&a.dataTransfer.files[0]&&h(a.dataTransfer.files[0])},[h]),F=a=>{a.target.files&&a.target.files[0]&&h(a.target.files[0])},I=()=>{o(null),f(null),i(""),m.current&&(m.current.value="")},R=a=>{if(a.preventDefault(),!s){i(l("image_analysis.upload.errors.no_file"));return}t({file:s,description:u})};return e.jsxs(d.form,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[l("image_analysis.upload.label")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),n?e.jsxs(d.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"relative",children:[e.jsx("img",{src:n,alt:"Preview",className:"w-full max-h-96 object-contain rounded-2xl border-2 border-gray-200 bg-gray-50"}),e.jsx("button",{type:"button",onClick:I,className:"absolute top-3 right-3 p-2 bg-red-600 text-white rounded-full hover:bg-red-700 transition-colors shadow-lg","aria-label":"Remove image",children:e.jsx(L,{className:"w-5 h-5"})}),s&&e.jsxs("p",{className:"text-sm text-gray-600 mt-3",children:["üìé ",s.name," (",(s.size/1024).toFixed(1)," KB)"]})]}):e.jsxs("div",{onDragEnter:N,onDragLeave:N,onDragOver:N,onDrop:A,onClick:()=>{var a;return(a=m.current)==null?void 0:a.click()},className:`
              relative border-2 border-dashed rounded-2xl p-12 text-center cursor-pointer
              transition-all duration-200
              ${g?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-purple-400 hover:bg-gray-50"}
            `,children:[e.jsxs(d.div,{animate:g?{scale:1.05}:{scale:1},transition:{duration:.2},children:[e.jsx(W,{className:`w-12 h-12 mx-auto mb-4 ${g?"text-purple-500":"text-gray-400"}`}),e.jsx("p",{className:"text-gray-700 font-medium mb-2",children:l(g?"image_analysis.upload.drop_here":"image_analysis.upload.drag_drop")}),e.jsx("p",{className:"text-sm text-gray-500",children:l("image_analysis.upload.formats")})]}),e.jsx("input",{ref:m,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp,image/bmp",onChange:F,className:"hidden"})]})]}),e.jsx(U,{label:l("image_analysis.upload.desc_label"),placeholder:l("image_analysis.upload.desc_placeholder"),value:u,onChange:a=>v(a.target.value),rows:3}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm",children:y}),e.jsx(S,{type:"submit",fullWidth:!0,size:"lg",loading:x,disabled:!s,icon:O,children:l("image_analysis.upload.analyze_btn")}),e.jsx("p",{className:"text-sm text-gray-500 text-center",children:l("image_analysis.upload.privacy")})]})},q=({data:t,image:x})=>{const l=T(),{t:s}=k();return e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s("image_analysis.result.title")})}),t.medical_attention_recommended&&e.jsx(c,{className:"!bg-amber-50 !border-2 !border-amber-200",hover:!1,animate:!1,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(d.div,{animate:{scale:[1,1.1,1]},transition:{duration:1,repeat:1/0},className:"p-2 bg-amber-100 rounded-xl",children:e.jsx(C,{className:"w-6 h-6 text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-bold text-amber-900 mb-2",children:["‚ö†Ô∏è ",s("image_analysis.result.medical_attention")]}),e.jsx("p",{className:"text-amber-800 text-sm mb-4",children:s("image_analysis.result.medical_attention_desc")}),e.jsx(S,{variant:"secondary",size:"sm",icon:E,onClick:()=>l("/hospitals"),children:s("image_analysis.result.find_hospital")})]})]})}),x&&e.jsxs(c,{hover:!1,animate:!1,children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-purple-600"}),s("image_analysis.result.analyzed_image")]}),e.jsx("img",{src:x,alt:"Analyzed",className:"w-full max-h-64 object-contain rounded-xl bg-gray-50"})]}),e.jsxs(c,{hover:!1,animate:!1,children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-[#2B6CB0]"}),s("image_analysis.result.observations")]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.description||s("image_analysis.result.no_observations")})]}),t.concerns&&t.concerns.length>0&&e.jsxs(c,{hover:!1,animate:!1,children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-amber-600"}),s("image_analysis.result.concerns")]}),e.jsx("ul",{className:"space-y-3",children:t.concerns.map((o,n)=>e.jsxs(d.li,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:n*.1},className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex-shrink-0 w-2 h-2 bg-purple-600 rounded-full mt-2"}),e.jsx("span",{className:"text-gray-700",children:o})]},n))})]}),t.advice&&e.jsxs(c,{hover:!1,animate:!1,children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-[#48BB78]"}),s("image_analysis.result.advice")]}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.advice})]}),t.image_info&&e.jsxs(c,{className:"!bg-gray-50",hover:!1,animate:!1,children:[e.jsx("h3",{className:"text-sm font-bold text-gray-700 mb-3",children:s("image_analysis.result.image_info")}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:s("image_analysis.result.filename")}),e.jsx("p",{className:"text-gray-700 font-medium truncate",children:t.image_info.filename})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:s("image_analysis.result.size")}),e.jsxs("p",{className:"text-gray-700 font-medium",children:[(t.image_info.size_bytes/1024).toFixed(1)," KB"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:s("image_analysis.result.type")}),e.jsx("p",{className:"text-gray-700 font-medium",children:t.image_info.mime_type})]})]})]}),e.jsx(K,{})]})},ee=()=>{const{t,i18n:x}=k(),[l,s]=r.useState(!1),[o,n]=r.useState(null),[f,u]=r.useState(null),v=async({file:p,description:y})=>{s(!0),n(null);try{const i=new FormData;i.append("image",p),i.append("language",x.language),y&&i.append("description",y);const m=new FileReader;m.onload=h=>u(h.target.result),m.readAsDataURL(p);const b=await $(i),j=b.data||b;n(j),j.medical_attention_recommended?_.warning("Analysis suggests you should consult a healthcare provider."):_.success("Image analysis complete!")}catch(i){console.error("Analysis error:",i),_.error(i.message||"Failed to analyze image. Please try again.")}finally{s(!1)}},g=()=>{n(null),u(null)};return e.jsxs("div",{className:"min-h-screen bg-[#F7FAFC]",children:[e.jsx("section",{className:"bg-white border-b border-gray-100",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12",children:e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-purple-50 rounded-2xl mb-4",children:e.jsx(H,{className:"w-8 h-8 text-purple-600"})}),e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-3",children:t("image_analysis.title")}),e.jsx("p",{className:"text-lg text-gray-600 max-w-xl mx-auto",children:t("image_analysis.subtitle")})]})})}),e.jsx("section",{className:"py-8 sm:py-12",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l?e.jsx(c,{children:e.jsx(P,{message:t("image_analysis.loading"),size:"default"})}):o?e.jsxs("div",{className:"space-y-6",children:[e.jsx(q,{data:o,image:f}),e.jsx("div",{className:"text-center",children:e.jsxs("button",{onClick:g,className:"text-purple-600 font-semibold hover:underline",children:["‚Üê ",t("image_analysis.new_analysis")]})})]}):e.jsx(c,{children:e.jsx(X,{onSubmit:v,loading:l})})})})]})};export{ee as default};
